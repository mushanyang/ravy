#!/bin/sh

# Run given command only if there is not one running.
singleton_command () { pgrep -f "(^| |/)$@( |\$)" > /dev/null || eval "$@"; }
singleton_command_background () { (singleton_command "$@" &) &>/dev/null; }

# Launch open-remote-monitor before ssh.
[ $(uname) = Darwin ] && singleton_command_background open-remote-monitor

exec ssh-stay "$@"
